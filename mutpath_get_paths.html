

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>mutpath_get_paths.py &mdash; mutpath 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="mutpath 0.1 documentation" href="index.html" />
    <link rel="up" title="Scripts" href="scripts.html" />
    <link rel="next" title="mutpath_annotate_tree.py" href="mutpath_annotate_tree.html" />
    <link rel="prev" title="mutpath_compact_trees.py" href="mutpath_compact_trees.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mutpath_annotate_tree.html" title="mutpath_annotate_tree.py"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mutpath_compact_trees.html" title="mutpath_compact_trees.py"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">mutpath 0.1 documentation</a> &raquo;</li>
          <li><a href="scripts.html" accesskey="U">Scripts</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="mutpath-get-paths-py">
<h1>mutpath_get_paths.py<a class="headerlink" href="#mutpath-get-paths-py" title="Permalink to this headline">¶</a></h1>
<p>Script for parsing mutational paths from <tt class="docutils literal"><span class="pre">.trees</span></tt> files created using <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> with the Markov Jumps mutation-mapping feature.</p>
<p>The <tt class="docutils literal"><span class="pre">.trees</span></tt> files contain trees with mutations mapped to branches as created by <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a>. With specification of a starting and ending sequence (<em>startseq</em> and <em>endseq</em>), each tree represents a specific mutational path through sequence space from the starting to the ending sequence. For each tree (possibly excluding some initial trees as specified by <em>burnin</em> below), the mutational path is extracted and written to the text file <em>mutpathsfile</em>. In addition, all of the non <em>burnin</em> trees are also written without the branch mutation annotations to the new <tt class="docutils literal"><span class="pre">.trees</span></tt> file <em>mergedtreesfile</em> that can later be analyzed by the <a class="reference external" href="http://beast.bio.ed.ac.uk/TreeAnnotator">TreeAnnotator</a>.</p>
<p>The input <tt class="docutils literal"><span class="pre">.trees</span></tt> files can either be those directly produced by <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a>, or can have been pre-processed by <tt class="docutils literal"><span class="pre">mutpath_compact_trees.py</span></tt>. However, if they have not been pre-processed by <tt class="docutils literal"><span class="pre">mutpath_compact_trees.py</span></tt> then running this script may consume a very large amount of memory.</p>
<p>To run this script, first create a text infile of the format described
below in this documentation. If you name this input file <tt class="docutils literal"><span class="pre">infile.txt</span></tt>, then you would
run the script with the single
input file as an argument:</p>
<div class="highlight-python"><pre>mutpath_get_paths.py infile.txt</pre>
</div>
<p>If the script is not executable on your platform, you can use:</p>
<div class="highlight-python"><pre>python mutpath_get_paths.py infile.txt</pre>
</div>
<div class="section" id="input-file-format">
<h2>Input file format<a class="headerlink" href="#input-file-format" title="Permalink to this headline">¶</a></h2>
<p>The input file should contain a series of keys (strings without spaces) that are followed by their values. Lines that begin with # are considered comments and are ignored, as are blank lines. The file should contain the following keys:</p>
<ul class="simple">
<li><em>intreefiles</em> should specify a list of strings giving the names of one or more <tt class="docutils literal"><span class="pre">.trees</span></tt> files. These file names cannot contain spaces. These should be the <tt class="docutils literal"><span class="pre">.trees</span></tt> files created by running <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> with the Markov Jumps mutation mapping. The <tt class="docutils literal"><span class="pre">.trees</span></tt> files can optionally have been compacted using <tt class="docutils literal"><span class="pre">mutpath_compact_trees.py</span></tt>. Note that all of these <tt class="docutils literal"><span class="pre">.trees</span></tt> files must be for the same input files, and so should be identical up to the beginning of the tree entries.</li>
<li><em>burnin</em> should specify how many trees from each file in <em>intreefiles</em> are removed as burn-in (i.e. equilibration). Note that this is the number of trees that are removed, not the number of MCMC steps. So for example, if you ran an MCMC of 20,000,000 steps sampling at every 10,000 steps, there are 2,000 trees in each file. So t remove the first 10%, you would set <em>burnin</em> to 200.</li>
<li><em>mergedtreesfile</em> should specify the name of the new <tt class="docutils literal"><span class="pre">.trees</span></tt> file we create that contains all of the trees specified in <em>intreefiles</em> after removing the <em>burnin</em> trees from each file, and after removing the branch annotations. This file may be rather large if you have not first run <tt class="docutils literal"><span class="pre">mutpath_compact_trees.py</span></tt> on the <em>intreefiles</em>. If <em>mergedtreefiles</em> already exists, it is overwritten.</li>
<li><em>fastafile</em> should specify a FASTA file with headers equal to the sequence names used to create the <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> input files used to generate the <em>intreefiles</em>, and then giving the full sequences. This file is used to annotate the sequences in the <em>intreesfiles</em>. In other words, when looking at the <em>intreefiles</em> taxa labels, each taxa label must correspond to a header in <em>fastafile</em>, and then have the sequence provided.</li>
<li><em>startseq</em> should specify the name of the starting sequence for the mutational path. This should be the same sequence name used in <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> input file, and so should be present in the taxa labels in the <tt class="docutils literal"><span class="pre">.trees</span></tt> file.</li>
<li><em>endseq</em> should specify the name of the ending sequence for the mutational path. Like <em>startseq</em>, it should be the same sequence name used in the taxa labels in the <tt class="docutils literal"><span class="pre">.trees</span></tt> file.</li>
<li><em>seqtype</em> should specify the sequence type: it can be &#8220;DNA&#8221; or &#8220;protein&#8221;.</li>
<li><em>mutpathsfile</em> should specify the name of the new <tt class="docutils literal"><span class="pre">.txt</span></tt> file that is created and contains all of the mutational paths. The format is described below. If <em>mutpathsfile</em> already exists, it is overwritten.</li>
</ul>
</div>
<div class="section" id="example-input-file">
<h2>Example input file<a class="headerlink" href="#example-input-file" title="Permalink to this headline">¶</a></h2>
<p>Here is an example input file:</p>
<div class="highlight-python"><pre># Input file to mutpath_get_paths.py
#
# List of six input files
intreefiles prots_BEASTrun_1/prots_compact.trees prots_BEASTrun_2/prots_compact.trees prots_BEASTrun_3/prots_compact.trees prots_BEASTrun_4/prots_compact.trees prots_BEASTrun_5/prots_compact.trees prots_BEASTrun_6/prots_compact.trees
#
# Remove the first 200 trees as burnin
burnin 200
#
# File to write merged trees after removing burnin, branch annotations
mergedtreesfile prot_trees_merged.trees
#
# FASTA file giving sequences for the strain names in intreefiles
fastafile prots.fasta
#
# Sequence type: DNA or protein
seqtype protein
#
# Name of starting and ending sequences for mutational path
startseq A/Aichi/2/1968_1968.50
endseq A/Brisbane/10/2007_2007.10
#
# File to write the mutational paths
mutpathsfile prot_mutpaths.txt</pre>
</div>
</div>
<div class="section" id="output-files">
<h2>Output files<a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h2>
<p>Running <tt class="docutils literal"><span class="pre">mutpath_get_paths.py</span></tt> creates two output files, <em>mergedtreesfile</em> and <em>mutpathsfile</em>.</p>
<ul>
<li><p class="first"><em>mergedtreesfile</em> is a new <tt class="docutils literal"><span class="pre">.trees</span></tt> file that contains all of the trees in the <em>intreefiles</em>, after removing the first <em>burnin</em> trees from each file. It also contains all of the preface and suffix information necessary to allow it to be read by <a class="reference external" href="http://beast.bio.ed.ac.uk/TreeAnnotator">TreeAnnotator</a>. The mutation annotations on the branches have been removed, which shrinks the file to a manageable size (particularly if you have already run <tt class="docutils literal"><span class="pre">mutpath_compact_trees.py</span></tt> on the <em>intreefiles</em> to remove other information). You may want to use <em>mergedtreefiles</em> to generate a maximum-clade credibility tree with <a class="reference external" href="http://beast.bio.ed.ac.uk/TreeAnnotator">TreeAnnotator</a>.</p>
</li>
<li><p class="first"><em>mutpathsfile</em> is a new <tt class="docutils literal"><span class="pre">.txt</span></tt> file that contains the mutational paths. It lists each of the paths numbered starting at 1. Within each path, the mutations are indicated with numbering starting at 1 for the first position in the sequence. The times for the mutations, the starting and ending strains, and the most recent common ancestor of these two strains, are also indicated. These times are measured in units before the most recent tip node (so the root node would have the largest value of time). Here is an example of a file with two paths:</p>
<div class="highlight-python"><pre>MUTPATH 1
startstrain_name A/Aichi/2/1968_1968.50
startstrain_seq ATGGCAATGGGCTAA
startstrain_time 42.5
endstrain_name A/Brisbane/10/2007_2007.10
endstrain_seq ATGACGATTGGATAA
endstrain_time 3.9
commonancestor_seq ATGGCGATGGGCTAA
commonancestor_time 43.12713
startstrain_to_commonancestor_path
A6G : 42.713
commonancestor_to_endstrain_path
G9T : 31.732
G4A : 25.1343
C12A : 10.134

MUTPATH 2
startstrain_name A/Aichi/2/1968_1968.50
startstrain_seq ATGGCAATGGGCTAA
startstrain_time 42.5
endstrain_name A/Brisbane/10/2007_2007.10
endstrain_seq ATGACGATTGGATAA
endstrain_time 3.9
commonancestor_seq ATGGCGATGGGCTAA
commonancestor_time 44.12713
startstrain_to_commonancestor_path
A6G : 42.113
G9T : 43.124
commonancestor_to_endstrain_path
G4A : 21.1343
C5A : 19.531
A5C : 19.402
C12A : 9.134</pre>
</div>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">mutpath_get_paths.py</a><ul>
<li><a class="reference internal" href="#input-file-format">Input file format</a></li>
<li><a class="reference internal" href="#example-input-file">Example input file</a></li>
<li><a class="reference internal" href="#output-files">Output files</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="mutpath_compact_trees.html"
                        title="previous chapter">mutpath_compact_trees.py</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mutpath_annotate_tree.html"
                        title="next chapter">mutpath_annotate_tree.py</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/mutpath_get_paths.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mutpath_annotate_tree.html" title="mutpath_annotate_tree.py"
             >next</a> |</li>
        <li class="right" >
          <a href="mutpath_compact_trees.html" title="mutpath_compact_trees.py"
             >previous</a> |</li>
        <li><a href="index.html">mutpath 0.1 documentation</a> &raquo;</li>
          <li><a href="scripts.html" >Scripts</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Jesse Bloom.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>