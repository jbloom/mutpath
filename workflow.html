

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Typical workflow &mdash; mutpath 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="mutpath 0.1 documentation" href="index.html" />
    <link rel="next" title="Scripts" href="scripts.html" />
    <link rel="prev" title="BEAST and BEAGLE" href="beastbeagle.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scripts.html" title="Scripts"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="beastbeagle.html" title="BEAST and BEAGLE"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">mutpath 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="typical-workflow">
<h1>Typical workflow<a class="headerlink" href="#typical-workflow" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/jbloom/mutpath/">mutpath</a> installs a number of scripts that perform the main operations of the package. A mutational path can be built by using these scripts along with <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a>. By default, the <a class="reference external" href="https://github.com/jbloom/mutpath/">mutpath</a> scripts are installed so that they can be run directory from the command line, taking a user-specified and created input text file.</p>
<p>The scripts themselves are documented individually in the following sections. This section gives an overall workflow of how these scripts can be used in conjunction with <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a>.</p>
<div class="section" id="create-the-beast-xml-file">
<h2>Create the <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> XML file<a class="headerlink" href="#create-the-beast-xml-file" title="Permalink to this headline">¶</a></h2>
<p>You may have your own strategy to create the <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> input XML file. If not, <a class="reference external" href="https://github.com/jbloom/mutpath/">mutpath</a> has a script to do this.</p>
<p>Specifically, you can use <tt class="docutils literal"><span class="pre">mutpath_parse_to_beastxml.py</span></tt> to create an input <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> XML file from the FASTA sequence files. You can do this by manually creating the text input file and then running:</p>
<div class="highlight-python"><pre>mutpath_parse_to_beastxml.py infile.txt</pre>
</div>
<p>where <tt class="docutils literal"><span class="pre">infile.txt</span></tt> is a text file that you have created that specifies the input variables. Note that this script will create files that provide information about sequences that are outliers in terms of their divergence. If you think that these might be mis-annotated sequences that should not be part of the tree, specify them for exclusion using the options provided in <tt class="docutils literal"><span class="pre">infile.txt</span></tt> and then run the script again. The final output of interest will be a <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> XML file.</p>
</div>
<div class="section" id="run-beast">
<h2>Run <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a><a class="headerlink" href="#run-beast" title="Permalink to this headline">¶</a></h2>
<p>You will want to run <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> on the XML file that you have created. Note that you will need to use <a class="reference external" href="http://beast.bio.ed.ac.uk/BEAGLE">BEAGLE</a>. Below is an example command if you have installed both <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> and <a class="reference external" href="http://beast.bio.ed.ac.uk/BEAGLE">BEAGLE</a> locally, and have an XML file named <tt class="docutils literal"><span class="pre">infile.xml</span></tt>:</p>
<div class="highlight-python"><pre>java -Xmx2024m -Xms2024m -Djava.library.path=/home/jbloom/BEAGLE_libs/lib -cp ~/BEAST/build/dist/beast.jar dr.app.beast.BeastMain -beagle infile.xml</pre>
</div>
<p>This will create a .trees and .log file with the prefix specified in <tt class="docutils literal"><span class="pre">infile.xml</span></tt>. You may want to run several replicates of <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> in different directories to create more MCMC data to analyze. Use <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">Tracer</a> to examine the <tt class="docutils literal"><span class="pre">.log</span></tt> files to see if you run enough steps of MCMC to give good effective sample sizes.</p>
</div>
<div class="section" id="compact-the-trees-file">
<h2>Compact the <tt class="docutils literal"><span class="pre">.trees</span></tt> file<a class="headerlink" href="#compact-the-trees-file" title="Permalink to this headline">¶</a></h2>
<p>Running <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> using the Markov Jumps mutation mapping will create a very large output <tt class="docutils literal"><span class="pre">.trees</span></tt> file. It may be helpful (although it is optional) to compact this file by removing unnecessary information. You can do this using <tt class="docutils literal"><span class="pre">mutpath_compact_trees.py</span></tt> by:</p>
<div class="highlight-python"><pre>mutpath_compact_trees.py treefile.trees</pre>
</div>
<p>This will create a more compact file called <tt class="docutils literal"><span class="pre">treefile_compact.trees</span></tt> which you can use for all subsequent commands. You can delete the larger file using:</p>
<div class="highlight-python"><pre>rm treefile.trees</pre>
</div>
<p>This command is not necessary, but will greatly reduce (typically by around 20-fold) the size of the <tt class="docutils literal"><span class="pre">.trees</span></tt> files.</p>
</div>
<div class="section" id="get-the-mutational-paths">
<h2>Get the mutational paths<a class="headerlink" href="#get-the-mutational-paths" title="Permalink to this headline">¶</a></h2>
<p>After running <a class="reference external" href="http://beast.bio.ed.ac.uk/Main_Page">BEAST</a> and possibly compacing the mutational paths with <tt class="docutils literal"><span class="pre">mutpath_compact_trees.py</span></tt>, you will have a large collection of trees in one or more <tt class="docutils literal"><span class="pre">.trees</span></tt> files. Use the script <tt class="docutils literal"><span class="pre">mutpath_get_paths.py</span></tt> to get the mutational paths from these trees. This script also merges all of the trees (without the mutation annotations) into a single <tt class="docutils literal"><span class="pre">.trees</span></tt> file that you can analyze with <a class="reference external" href="http://beast.bio.ed.ac.uk/TreeAnnotator">TreeAnnotator</a> to make a maximum-clade credibility tree. The output of this script is a <tt class="docutils literal"><span class="pre">.txt</span></tt> file that contains the mutational paths between the specified starting and ending sequence. To do this, you manually create the text input file and then run:</p>
<div class="highlight-python"><pre>mutpath_get_paths.py infile.txt</pre>
</div>
<p>The <tt class="docutils literal"><span class="pre">.txt</span></tt> file containing the mutational paths can then be analyzed by later scripts.</p>
</div>
<div class="section" id="making-and-annotating-the-maximum-clade-credibility-tree">
<h2>Making and annotating the maximum clade credibility tree<a class="headerlink" href="#making-and-annotating-the-maximum-clade-credibility-tree" title="Permalink to this headline">¶</a></h2>
<p>After running <tt class="docutils literal"><span class="pre">mutpath_get_paths.py</span></tt>, all of the various <tt class="docutils literal"><span class="pre">.trees</span></tt> files will have had their non-burnin trees combined into a single merged <tt class="docutils literal"><span class="pre">.trees</span></tt> file. Let&#8217;s say we called that file <tt class="docutils literal"><span class="pre">merged_trees.trees</span></tt>. You can then use <a class="reference external" href="http://beast.bio.ed.ac.uk/TreeAnnotator">TreeAnnotator</a> to make a maximum clade credibility tree, which in turn can be visualized by <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>. To do this, make sure that you have <cite>TreeAnnotator</cite> installed such that the <tt class="docutils literal"><span class="pre">treeannotator</span></tt> executable is accessible, and then run:</p>
<div class="highlight-python"><pre>treeannotator merged_trees.trees maxcladecredibility.trees</pre>
</div>
<p>to create the maximum clade credibility tree in <tt class="docutils literal"><span class="pre">maxcladecredibility.trees</span></tt>. This tree can then be visualized with <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>. In order to format it for better viewing with <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>, you can use the script <tt class="docutils literal"><span class="pre">mutpath_annotate_tree.py</span></tt>. Create an input file specifying how you want to label tip nodes in this tree, and then run:</p>
<div class="highlight-python"><pre>mutpath_annotate_tree.py infile.txt</pre>
</div>
<p>This will create an annotated <tt class="docutils literal"><span class="pre">.tree</span></tt> file with the name that you specify in the input file. You can visualize this tree (and if you want further annotate it) using <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>.</p>
</div>
<div class="section" id="constructing-the-mutational-trajectory">
<h2>Constructing the mutational trajectory<a class="headerlink" href="#constructing-the-mutational-trajectory" title="Permalink to this headline">¶</a></h2>
<p>After running <tt class="docutils literal"><span class="pre">mutpath_get_paths.py</span></tt> to create the <tt class="docutils literal"><span class="pre">.txt</span></tt> file containing the mutational paths, you can then use <tt class="docutils literal"><span class="pre">mutpath_make_digraph.py</span></tt> to visualize and analyze the mutational trajectory. The mutational trajectory is the path from the starting sequence to the ending sequence through sequence space, and the probability of different paths in the trajectory is taken as proportional to the number of paths in the <tt class="docutils literal"><span class="pre">.txt</span></tt> mutational path file that take that portion of the trajectory. To create these paths, create an input file. Then run the script:</p>
<div class="highlight-python"><pre>mutpath_make_digraph.py infile.txt</pre>
</div>
<p>This will generate a <a class="reference external" href="http://www.graphviz.org/doc/info/lang.html">DOT</a> file containing the mutational trajectory as a directed graph through protein sequence space that can be visualized in <a class="reference external" href="http://www.graphviz.org/">GraphViz</a>. You can also use <a class="reference external" href="http://www.graphviz.org/">GraphViz</a> to save this trajectory in a PDF or other file format. In addition, this script will output information about the dates of mutations and the times for which nodes persisted.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Typical workflow</a><ul>
<li><a class="reference internal" href="#create-the-beast-xml-file">Create the BEAST XML file</a></li>
<li><a class="reference internal" href="#run-beast">Run BEAST</a></li>
<li><a class="reference internal" href="#compact-the-trees-file">Compact the <tt class="docutils literal"><span class="pre">.trees</span></tt> file</a></li>
<li><a class="reference internal" href="#get-the-mutational-paths">Get the mutational paths</a></li>
<li><a class="reference internal" href="#making-and-annotating-the-maximum-clade-credibility-tree">Making and annotating the maximum clade credibility tree</a></li>
<li><a class="reference internal" href="#constructing-the-mutational-trajectory">Constructing the mutational trajectory</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="beastbeagle.html"
                        title="previous chapter">BEAST and BEAGLE</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scripts.html"
                        title="next chapter">Scripts</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/workflow.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scripts.html" title="Scripts"
             >next</a> |</li>
        <li class="right" >
          <a href="beastbeagle.html" title="BEAST and BEAGLE"
             >previous</a> |</li>
        <li><a href="index.html">mutpath 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Jesse Bloom.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>